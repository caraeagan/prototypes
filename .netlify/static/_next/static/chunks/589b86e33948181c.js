(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,83806,e=>{"use strict";e.s(["default",()=>r]);var t=e.i(43476),s=e.i(71645);function r(){let[e,r]=(0,s.useState)([]),[l,a]=(0,s.useState)(!0);(0,s.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/get-results"),t=await e.json();if(t.success){let e=t.results||[],s=[];for(let t=0;t<localStorage.length;t++){let r=localStorage.key(t);if(r&&r.startsWith("test_completed_"))try{let t=JSON.parse(localStorage.getItem(r)||"{}"),l=r.replace("test_completed_","");if(e.find(e=>e.sessionId===l))continue;let a=localStorage.getItem("student_".concat(l)),o=a?JSON.parse(a):null,c=localStorage.getItem("pattern_reasoning_test_".concat(l)),n=c?JSON.parse(c):[];if("pattern_reasoning"===t.testType||"pattern-reasoning"===t.subtest){let e=n.filter(e=>e.isCorrect).length,r=n.length,a=r>0?Math.round(e/r*100):0,c={};n.forEach(e=>{let t=e.ageGroup||"Unknown";c[t]||(c[t]={total:0,correct:0}),c[t].total+=1,e.isCorrect&&(c[t].correct+=1)});let i={};Object.keys(c).forEach(e=>{let t=c[e];i[e]={total:t.total,correct:t.correct,percentage:t.total>0?Math.round(t.correct/t.total*100):0}}),s.push({sessionId:l,name:(null==o?void 0:o.firstName)||t.studentName||"Unknown",completedAt:t.completedAt||t.timestamp,totalQuestions:r,correctAnswers:e,score:t.score||a,results:n,ageGroupStats:i,isFiltered:t.isFiltered||!1,filterType:t.filterType||"all"})}}catch(e){console.error("Error parsing local result:",e)}}let l=[...e,...s];l.sort((e,t)=>new Date(t.completedAt).getTime()-new Date(e.completedAt).getTime()),r(l)}else throw Error("Failed to fetch from API")}catch(t){console.error("Error loading results:",t);let e=[];for(let t=0;t<localStorage.length;t++){let s=localStorage.key(t);if(s&&s.startsWith("test_completed_"))try{let t=JSON.parse(localStorage.getItem(s)||"{}"),r=s.replace("test_completed_",""),l=localStorage.getItem("student_".concat(r)),a=l?JSON.parse(l):null,o=localStorage.getItem("pattern_reasoning_test_".concat(r)),c=o?JSON.parse(o):[];if("pattern_reasoning"===t.testType||"pattern-reasoning"===t.subtest){let s=c.filter(e=>e.isCorrect).length,l=c.length,o=l>0?Math.round(s/l*100):0,n={};c.forEach(e=>{let t=e.ageGroup||"Unknown";n[t]||(n[t]={total:0,correct:0}),n[t].total+=1,e.isCorrect&&(n[t].correct+=1)});let i={};Object.keys(n).forEach(e=>{let t=n[e];i[e]={total:t.total,correct:t.correct,percentage:t.total>0?Math.round(t.correct/t.total*100):0}}),e.push({sessionId:r,name:(null==a?void 0:a.firstName)||t.studentName||"Unknown",completedAt:t.completedAt||t.timestamp,totalQuestions:l,correctAnswers:s,score:t.score||o,results:c,ageGroupStats:i,isFiltered:t.isFiltered||!1,filterType:t.filterType||"all"})}}catch(e){console.error("Error parsing result:",e)}}e.sort((e,t)=>new Date(t.completedAt).getTime()-new Date(e.completedAt).getTime()),r(e)}a(!1)})()},[]);let o=async(t,s)=>{if(confirm("Are you sure you want to delete ".concat(s,"'s test result? This cannot be undone.")))try{let l=!1;try{let e=await fetch("/api/delete-result",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionId:t})});if(e.ok)l=!0;else{let t=await e.json();console.log("API delete failed:",t.error)}}catch(e){console.log("API delete error:",e)}let a={completed:!!localStorage.getItem("test_completed_".concat(t)),test:!!localStorage.getItem("pattern_reasoning_test_".concat(t)),student:!!localStorage.getItem("student_".concat(t))};localStorage.removeItem("test_completed_".concat(t)),localStorage.removeItem("pattern_reasoning_test_".concat(t)),localStorage.removeItem("student_".concat(t));let o=a.completed||a.test||a.student;l||o?(r(e.filter(e=>e.sessionId!==t)),alert("Successfully deleted ".concat(s,"'s test result."))):alert("Could not find ".concat(s,"'s test result to delete."))}catch(e){console.error("Error deleting result:",e),alert("Error deleting result. Please try again.")}};return l?(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-900 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Loading results..."})]})}):(0,t.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Pattern Reasoning Test Results"}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)("button",{onClick:()=>window.location.href="/analytics",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"View Analytics"}),(0,t.jsx)("button",{onClick:()=>{if(0===e.length)return;let t=["Name","Session ID","Completed At","Total Questions","Correct Answers","Score (%)"],s=Math.max(...e.map(e=>e.totalQuestions));for(let e=1;e<=s;e++)t.push("Q".concat(e," Answer")),t.push("Q".concat(e," Correct"));let r=new Blob([[t.join(","),...e.map(e=>{let t=[e.name,e.sessionId,new Date(e.completedAt).toLocaleString(),e.totalQuestions,e.correctAnswers,e.score];for(let l=0;l<s;l++){let s=e.results[l];if(s){var r;t.push((null==(r=s.answer)?void 0:r.answer)||"No Answer"),t.push(s.isCorrect?"Correct":"Incorrect")}else t.push("No Answer"),t.push("Incorrect")}return t.join(",")})].join("\\n")],{type:"text/csv"}),l=window.URL.createObjectURL(r),a=document.createElement("a");a.href=l,a.download="pattern-reasoning-results-".concat(new Date().toISOString().split("T")[0],".csv"),a.click(),window.URL.revokeObjectURL(l)},disabled:0===e.length,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Export CSV"}),(0,t.jsx)("button",{onClick:()=>{if(confirm("Are you sure you want to clear all results? This cannot be undone.")){let e=[];for(let t=0;t<localStorage.length;t++){let s=localStorage.key(t);s&&(s.startsWith("test_completed_")||s.startsWith("pattern_reasoning_test_")||s.startsWith("student_"))&&e.push(s)}e.forEach(e=>localStorage.removeItem(e)),r([])}},disabled:0===e.length,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Clear All"})]})]}),0===e.length?(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)("p",{className:"text-gray-500 text-lg",children:"No test results found"}),(0,t.jsx)("p",{className:"text-gray-400 mt-2",children:"Results will appear here after people complete the pattern reasoning test"})]}):(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"min-w-full table-auto",children:[(0,t.jsx)("thead",{className:"bg-gray-50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Test Type"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Completed"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Questions"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Overall Score"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Age Group Breakdown"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,t.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(e=>(0,t.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,t.jsxs)("td",{className:"px-4 py-4 whitespace-nowrap",children:[(0,t.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,t.jsx)("div",{className:"text-sm text-gray-500",children:e.sessionId})]}),(0,t.jsx)("td",{className:"px-4 py-4 whitespace-nowrap",children:(0,t.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(e.isFiltered?"bg-purple-100 text-purple-800":"bg-blue-100 text-blue-800"),children:e.isFiltered?"Ages 12+":"All Ages"})}),(0,t.jsx)("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.completedAt).toLocaleString()}),(0,t.jsx)("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:e.totalQuestions}),(0,t.jsx)("td",{className:"px-4 py-4 whitespace-nowrap",children:(0,t.jsxs)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(e.score>=80?"bg-green-100 text-green-800":e.score>=60?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:[e.score,"% (",e.correctAnswers,"/",e.totalQuestions,")"]})}),(0,t.jsx)("td",{className:"px-4 py-4",children:(0,t.jsx)("div",{className:"text-xs space-y-1",children:Object.entries(e.ageGroupStats||{}).map(e=>{let[s,r]=e;return(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("span",{className:"font-medium text-gray-600",children:[s,":"]}),(0,t.jsxs)("span",{className:"px-2 py-1 rounded text-xs ".concat(r.percentage>=80?"bg-green-100 text-green-800":r.percentage>=60?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:[r.percentage,"% (",r.correct,"/",r.total,")"]})]},s)})})}),(0,t.jsx)("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-500",children:(0,t.jsxs)("div",{className:"flex space-x-3",children:[(0,t.jsx)("button",{onClick:()=>{window.location.href="/results/".concat(e.sessionId)},className:"text-blue-600 hover:text-blue-900",children:"View Details"}),(0,t.jsx)("button",{onClick:()=>o(e.sessionId,e.name),className:"text-red-600 hover:text-red-900",children:"Delete"})]})})]},e.sessionId))})]})})]})})})}}]);